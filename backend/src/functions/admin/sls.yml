provider:
  name: aws
  runtime: python3.6
  versionFunctions: false
  stage: dev

functions:
  AdminGetOrders:
    name: DVSA-ADMIN-GET-ORDERS
    handler: backend/src/functions/admin/admin_get_orders.lambda_handler
    policies:
        - AWSLambdaFullAccess
    environment:
      ORDERS_TABLE: DVSA-ORDERS-DB
    timeout: 10
    memorySize: 128
    package: 
      include: 
        - backend/src/functions/admin/admin_get_orders.py

  AdminGetReceipt:
    name: DVSA-ADMIN-GET-RECEIPT
    handler: backend/src/functions/admin/admin_get_receipts.lambda_handler
    policies:
        - AWSLambdaFullAccess
    environment:
      RECEIPTS_BUCKET: !Sub dvsa-receipts-bucket-${AWS::AccountId}
    timeout: 10
    memorySize: 128
    package: 
      include: 
        - backend/src/functions/admin/admin_get_receipts.py

  AdminUpdateOrders:
    name: DVSA-ADMIN-UPDATE-ORDERS
    handler: backend/src/functions/admin/admin_update_orders.lambda_handler
    policies:
        - AWSLambdaFullAccess
    environment:
      ORDERS_TABLE: DVSA-ORDERS-DB
    timeout: 10
    memorySize: 128
    package: 
      include: 
        - backend/src/functions/admin/admin_update_orders.py

  AdminUpdateInventory:
    name: DVSA-ADMIN-UPDATE-INVENTORY
    handler: backend/src/functions/admin/admin_update_inventory.lambda_handler
    policies:
        - AWSLambdaFullAccess
    environment:
      INVENTORY_TABLE: DVSA-INVENTORY-DB
    timeout: 10
    memorySize: 128
    package: 
      include: 
        - backend/src/functions/admin/admin_update_inventory.py

  AdminTweet:
    name: DVSA-ADMIN-TWEET
    handler: backend/src/functions/admin/admin_tweet.lambda_handler
    policies:
        - AWSLambdaFullAccess
    environment:
      TWITTER_ACCESS_TOKEN: zzzzzzzzzzzzzzzzzzzzzzz
      TWITTER_API: https://api.twitter.com/
      TWITTER_TOKEN_SECRET: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    timeout: 10
    memorySize: 128
    package: 
      include: 
        - backend/src/functions/admin/admin_tweet.py
  
  AdminShell:
    name: DVSA-ADMIN-SHELL
    handler: backend/src/functions/admin/admin_shell.lambda_handler
    policies:
        - AWSLambdaFullAccess
    events:
      - http:
          method: post
          path: admin
    environment:
      userpoolid:
        Ref: CognitoUserPoolMyUserPool
    timeout: 10
    memorySize: 128
    package: 
      include: 
        - backend/src/functions/admin/admin_shell.py
        - backend/src/functions/admin/jsonpickle
        
  AdminOrdersMysql:
    name: DVSA-ADMIN-ORDERS-MYSQL
    runtime: nodejs12.x
    events:
      - http:
          method: post
          path: orders
    handler: backend/src/functions/admin/admin_orders_mysql.handler
    policies:
        - AWSLambdaFullAccess
    environment:
      db_name: bvl1zuoffpflrto3zdrt
      db_pw: lQ8PQBkxAqFFCizNI5vt
      db_url: bvl1zuoffpflrto3zdrt-mysql.services.clever-cloud.com
      db_user: uk7kkjxwjxurqudy
    timeout: 30
    memorySize: 256
    package: 
      include: 
        - backend/src/functions/admin/admin_orders_mysql.js
